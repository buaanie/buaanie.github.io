<!DOCTYPE html>
<html lang=zh>
<head>
    <meta charset="utf-8">
    
    <title>背包问题 | buaanie&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="复习背包问题，java实现">
<meta name="keywords" content="算法,动态规划,背包问题">
<meta property="og:type" content="article">
<meta property="og:title" content="背包问题">
<meta property="og:url" content="https://buaanie.github.io/2017/10/02/背包问题/index.html">
<meta property="og:site_name" content="buaanie&#39;s blog">
<meta property="og:description" content="复习背包问题，java实现">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-10-02T16:18:07.501Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="背包问题">
<meta name="twitter:description" content="复习背包问题，java实现">
    

    
        <link rel="alternate" href="/" title="buaanie&#39;s blog" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">buaanie&#39;s blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/categories">Categories</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/placebo.jpg" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/categories">Categories</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/placebo.jpg" />
            <h2 id="name">niej</h2>
            <h3 id="title">Developer</h3>
            <span id="location"><i class="fa fa-map-marker"></i>Beijing, China</span>
            <a id="follow" target="_blank" href="https://github.com/buaanie/">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                7
                <span>文章</span>
            </div>
            <div class="article-info-block">
                11
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/buaanie/" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="facebook" class=tooltip>
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="dribbble" class=tooltip>
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-背包问题" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            背包问题
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2017/10/02/背包问题/">
            <time datetime="2017-10-02T13:30:08.000Z" itemprop="datePublished">2017-10-02</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/算法笔记/">算法笔记</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/动态规划/">动态规划</a>, <a class="tag-link" href="/tags/算法/">算法</a>, <a class="tag-link" href="/tags/背包问题/">背包问题</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>笔试时候遇到的动态规划问题比较多，背包问题比较有代表性，所以自己手动全部实现一遍，加深转移方程的推导与实现的记忆。下面依次介绍01背包（每种物品只有1个）、完全背包（每种物品有无限个）、多重背包（每种物品各有限制）</p>
<h2 id="01背包"><a href="#01背包" class="headerlink" title="01背包"></a>01背包</h2><p>背包容量为cubage，物品种类为cate种，物品i花费为cost[i]，价值为value[i]<br>对于二维数组dp[i][j]表示容积为j放入前i种物品的最优解（价值最大值）<br>//代码中注释都说的比较详细，就不展开了，中途会插入一些参考链接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) &#123;</div><div class="line">	Scanner sc = new Scanner(System.in);</div><div class="line">	int cubage = sc.nextInt();</div><div class="line">	int cate = sc.nextInt(),i=1;</div><div class="line">	int[] value = new int[cate+1];</div><div class="line">	int[] cost = new int[cate+1];</div><div class="line">	while(i&lt;=cate)&#123;</div><div class="line">		cost[i]=sc.nextInt();</div><div class="line">		value[i]=sc.nextInt();</div><div class="line">		i++;</div><div class="line">	&#125;</div><div class="line">	parse01Normal(value,cost,cubage,cate);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<h4 id="下面是必须不装满的情况："><a href="#下面是必须不装满的情况：" class="headerlink" title="下面是必须不装满的情况："></a>下面是必须不装满的情况：</h4><p>状态转移方程：dp[i][j]= max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1<br>如果需要还原最优解的物品，需要定义path[][]保存记录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">private static void parse01Normal(int[] value, int[] cost, int cubage, int cate) &#123;</div><div class="line">	int i=0,j=0;</div><div class="line">	//dp[i][j]表示容量为j且物品种类为i个时的最优解（最大价值）</div><div class="line">	int[][] dp = new int[cate+1][cubage+1];</div><div class="line">	//path[][]用于还原路径</div><div class="line">	int[][]  path = new int[cate+1][cubage+1];</div><div class="line">	for(i=0;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=0;j&lt;=cubage;j++)&#123;</div><div class="line">			if(i==0||j==0)</div><div class="line">				dp[i][j]=0;</div><div class="line">			else&#123;</div><div class="line">				//dp[i][j]= max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1</div><div class="line">				// 先默认不放入，即此时容量为j也只放前i-1个物品</div><div class="line">				dp[i][j]=dp[i-1][j];</div><div class="line">				//如果容积够，并且放入之后价值提升（j-cost[i]容积下放入前i-1个商品前提下,再放入当前商品），则放入</div><div class="line">				if(cost[i]&lt;=j &amp;&amp; (dp[i-1][j-cost[i]]+value[i])&gt;dp[i-1][j]) &#123;</div><div class="line">					dp[i][j] = dp[i - 1][j - cost[i]] + value[i];</div><div class="line">					path[i][j]=1;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	i--;j--;</div><div class="line">	while(i&gt;0 &amp;&amp; j&gt;0)&#123;</div><div class="line">		if(path[i][j]==1)&#123;</div><div class="line">			System.out.print(i+ &quot;-&gt;&quot;);</div><div class="line">			j-=value[i];</div><div class="line">		&#125;</div><div class="line">		i--;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">//        for(i=1;i&lt;=cate;i++)&#123;</div><div class="line">//            for(j=1;j&lt;=cubage;j++) &#123;</div><div class="line">//                System.out.print(dp[i][j]+&quot; &quot;);</div><div class="line">//            &#125;</div><div class="line">//            System.out.println();</div><div class="line">//        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="必须装满"><a href="#必须装满" class="headerlink" title="必须装满"></a>必须装满</h4><p>此时相当于必须从[0][0]位开始转移方程，可以在初始化的时候讲第一行[0][1~cubage]赋值为-1，在判断转移条件的时候如果为-1则不转移<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">private static void parse01Full(int[] value, int[] cost, int cubage, int cate) &#123;</div><div class="line">	int i=0,j=0;</div><div class="line">	//dp[i][j]表示容量为j且物品种类为i个时的最优解（最大价值）</div><div class="line">	int[][] dp = new int[cate+1][cubage+1];</div><div class="line">	//path[][]用于还原路径</div><div class="line">	int[][]  path = new int[cate+1][cubage+1];</div><div class="line">	dp[0][0]=0;</div><div class="line">	//初始化的时候将不是从0开始</div><div class="line">//        for(i=1;i&lt;cate;i++)</div><div class="line">//            dp[i][0]=-10000;</div><div class="line">	//可以将非[0][0]值为-1，再判断转移的时候为-1则不转移</div><div class="line">	//不过也可以直接赋为负无穷，这样判断大小的时候同样不会转移</div><div class="line">	for(i=1;i&lt;cubage;i++)</div><div class="line">		dp[0][i]=-10000;</div><div class="line">	for(i=1;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=1;j&lt;=cubage;j++)&#123;</div><div class="line">			//dp[i][j]= max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1</div><div class="line">			// 先默认不放入，即此时容量为j也只放前i-1个物品</div><div class="line">			dp[i][j]=dp[i-1][j];</div><div class="line">			//如果容积够，并且放入之后价值提升（j-cost[i]容积下放入前i-1个商品前提下再放入当前商品），则放入</div><div class="line">			if(cost[i]&lt;=j &amp;&amp; (dp[i-1][j-cost[i]]+value[i])&gt;dp[i-1][j]) &#123;</div><div class="line">				dp[i][j] = dp[i - 1][j - cost[i]] + value[i];</div><div class="line">				path[i][j]=1;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	for(i=1;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=1;j&lt;=cubage;j++) &#123;</div><div class="line">			System.out.print(dp[i][j]+&quot; &quot;);</div><div class="line">		&#125;</div><div class="line">		System.out.println();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="滚动优化"><a href="#滚动优化" class="headerlink" title="滚动优化"></a>滚动优化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">private static void parse01Update(int[] value, int[] cost, int cubage, int cate) &#123;</div><div class="line">	int i=0,j=0,k=0;</div><div class="line">	//dp[2][j] 当前价值只与上层相关，可优化为滚动2*cubage数组。</div><div class="line">	int[][] dp = new int[2][cubage+1];</div><div class="line">	for(i=0;i&lt;=cate;i++)&#123;</div><div class="line">		k=1-k;//也可转为k^1</div><div class="line">		for(j=0;j&lt;=cubage;j++)&#123;</div><div class="line">			if(i==0||j==0)</div><div class="line">				dp[k][j]=0;</div><div class="line">			else&#123;</div><div class="line">				dp[k][j]=dp[1-k][j];</div><div class="line">				if(cost[i]&lt;=j &amp;&amp; (dp[1-k][j-cost[i]]+value[i])&gt;dp[1-k][j]) &#123;</div><div class="line">					dp[k][j] = dp[1-k][j-cost[i]] + value[i];</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	System.out.println(dp[k][cubage]);</div><div class="line">	//凡是可以滚动的，必定可以降维</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="一维数组优化"><a href="#一维数组优化" class="headerlink" title="一维数组优化"></a>一维数组优化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">private static void parse01Optimize(int[] value, int[] cost, int cubage, int cate) &#123;</div><div class="line">	int i=0,j=0,k=0;</div><div class="line">	//dp[] 只与上层左侧部分相关，优化为一维数组</div><div class="line">	//max(dp[i-1][j-cost[i]]+value[i] , dp[i-1][j])</div><div class="line">	int[] dp = new int[cubage+1];</div><div class="line">	for(i=0;i&lt;=cate;i++)&#123;</div><div class="line">		//依赖上层保存的j-cost[i]信息，所以此时需要从后往前更新</div><div class="line">		for(j=cubage;j&gt;=cost[i];j--)&#123;</div><div class="line">			if(i==0)</div><div class="line">				dp[j]=0;</div><div class="line">			else if(dp[j-cost[i]]+value[i]&gt;dp[j])</div><div class="line">				dp[j]=dp[j-cost[i]]+value[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	for(i=0;i&lt;=cubage;i++)</div><div class="line">		System.out.print(dp[i]+&quot; &quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="完全背包"><a href="#完全背包" class="headerlink" title="完全背包"></a>完全背包</h2><p>状态转移方程：dp[i][j]= max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1…| (cubage/cost[i])<br>//对于完全背包，如果w[i]&lt;=w[j] &amp;&amp; v[i]&gt;=v[j] 则可以直接无视j物品<br>注意下面的代码中有一次优化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">private static void parseWQNormal(int[] value, int[] cost, int cubage, int cate) &#123;</div><div class="line">	//注意此时物品并非只有一个，而是有无穷个，所以不只是放还是不放的问题</div><div class="line">	//dp[i][j]= max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1...| (cubage/cost[i])</div><div class="line">	int[][] dp = new int[cate+1][cubage+1];</div><div class="line">	int i=0,j=0;</div><div class="line">	for(i=0;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=0;j&lt;=cubage;j++)&#123;</div><div class="line">			if(i==0||j==0)</div><div class="line">				dp[i][j]=0;</div><div class="line">			else &#123;</div><div class="line">				dp[i][j] = dp[i-1][j];</div><div class="line">//                for(int k=1;k&lt;=j/cost[i];k++)&#123;</div><div class="line">//                    //注意此时j:0-&gt;cubage 其实每次都是以当前点重新计算，会重复计算</div><div class="line">//                    dp[i][j] = Math.max(dp[i][j],dp[i-1][j-k*cost[i]]+k*value[i]);</div><div class="line">//                &#125;</div><div class="line">				//计算dp[i][j]的时候其实考虑的是 max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1...| (cubage/cost[i])</div><div class="line">				//计算dp[i][j+cost[i]]的时候考虑的是 max(dp[i-1][(j+cost[i])-k*cost[i]]+k*value[i]) , k=0|1...| (cubage/cost[i])</div><div class="line">				//可以看出，dp[i][j+cost[i]] = max(dp[i][j]+value[i],dp[i-1][j+cost[i]])</div><div class="line">				if (j &gt;= cost[i] &amp;&amp; (dp[i][j]&lt;(dp[i][j-cost[i]]+value[i]))) &#123; //注意与01背包的不同点</div><div class="line">					dp[i][j] = dp[i][j-cost[i]]+value[i];</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	for(i=1;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=1;j&lt;=cubage;j++) &#123;</div><div class="line">			System.out.print(dp[i][j]+&quot; &quot;);</div><div class="line">		&#125;</div><div class="line">		System.out.println();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>同样可以用一维数组优化<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">private static void parseWQOptimize(int[] value, int[] cost, int cubage, int cate) &#123;</div><div class="line">	int[] dp = new int[cubage+1];</div><div class="line">	int i=0,j=0;</div><div class="line">	for(i=0;i&lt;=cate;i++)&#123;</div><div class="line">		//依赖上次保存的同层j-cost[i]信息，所以此时需要从前往后更新</div><div class="line">		//注意当j&lt;=cost[i]时</div><div class="line">		for(j=cost[i];j&lt;=cubage;j++)&#123;//注意此处与01背包区别</div><div class="line">			if(i==0)</div><div class="line">				dp[j]=0;</div><div class="line">			else&#123;</div><div class="line">				if(dp[j-cost[i]]+value[i]&gt;=dp[j])</div><div class="line">					dp[j]=dp[j-cost[i]]+value[i];</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	for(j=1;j&lt;=cubage;j++) &#123;</div><div class="line">		System.out.print(dp[j]+&quot; &quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="多重背包"><a href="#多重背包" class="headerlink" title="多重背包"></a>多重背包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">public static void main(String[] args) &#123;</div><div class="line">	Scanner sc = new Scanner(System.in);</div><div class="line">	int cubage = sc.nextInt();</div><div class="line">	int cate = sc.nextInt(),i=1;</div><div class="line">	int[] value = new int[cate+1];</div><div class="line">	int[] cost = new int[cate+1];</div><div class="line">	int[] count = new int[cate+1];</div><div class="line">	while(i&lt;=cate)&#123;</div><div class="line">		cost[i]=sc.nextInt();</div><div class="line">		value[i]=sc.nextInt();</div><div class="line">		count[i]=sc.nextInt();</div><div class="line">		i++;</div><div class="line">	&#125;</div><div class="line">	parseDCOptmize(value,cost,count,cubage,cate);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>常规思路复杂度仍然是O(cubage*cate*sum(count[i]))<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">private static void parseDCNormal(int[] value, int[] cost, int[] count, int cubage, int cate) &#123;</div><div class="line">	int[][] dp = new int[cate+1][cubage+1];</div><div class="line">	int i=0,j=0;</div><div class="line">	//dp[i][j]= max(dp[i-1][j-k*cost[i]]+k*value[i]) , k=0|1...|count[i]</div><div class="line">	for(i=0;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=cost[i];j&lt;=cubage;j++)&#123;</div><div class="line">			if(i==0||j==0)</div><div class="line">				dp[i][j]=0;</div><div class="line">			else &#123;</div><div class="line">				int min = Math.min(count[i], j / cost[i]);</div><div class="line">				for (int k = 0; k &lt;= min; k++) &#123;</div><div class="line">					dp[i][j] = Math.max(dp[i][j], dp[i-1][j-k*cost[i]] + k * value[i]);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	for(i=1;i&lt;=cate;i++)&#123;</div><div class="line">		for(j=1;j&lt;=cubage;j++) &#123;</div><div class="line">			System.out.print(dp[i][j]+&quot; &quot;);</div><div class="line">		&#125;</div><div class="line">		System.out.println();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>一个容易想到的优化方案是转化为01背包，但是按照二进制分割，可以保证复杂度为O(cubage*sum(log<sub>2</sub><sup>count[i]</sup>))</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">private static void parseDCOptmize(int[] value, int[] cost, int[] count, int cubage, int cate) &#123;</div><div class="line">	//注意如果count[i]*cost[i]&gt;cubage，其实等同于完全背包</div><div class="line">	//此时需要用到二进制思想对物品进行分割，将一种多件物品转化为多种一件物品，转化为01背包问题</div><div class="line">	//思考：二进制数每一位0表示不取，1表示取，这样我们就可以取遍所有的数</div><div class="line">	//过程：对于第i件物品，将count[i]分解为若干个数的组合，使得参数可以组合成任意小于等于count[i]的件数</div><div class="line">	//比如7=111，分解为001,010,100可表示任意&lt;=7的数；13=1101，分解为001,010,100,0110前三数表示&lt;=7,加上0110=6，可表示&lt;=13的数</div><div class="line">	//系数分别为1,2,4,...,2^(k-1),count[i]-2^k+1，k是满足count[i]-2^k+1&gt;0的最大整数</div><div class="line">	int i=1,j=0,cate_new=//下面给出转换代码</div><div class="line">	int[] value_new = new int[1000];//取1000最大</div><div class="line">	int[] cost_new = new int[1000];//取1000最大</div><div class="line">	while(i&lt;=cate)&#123;</div><div class="line">		for(j=1;j&lt;=count[i];j&lt;&lt;=1)&#123;//右移</div><div class="line">			value_new[cate_new] = j*value[i];</div><div class="line">			cost_new[cate_new]=j*cost[i];</div><div class="line">			cate_new++;</div><div class="line">			count[i]-=j;</div><div class="line">		&#125;</div><div class="line">		if(count[i]&gt;0)&#123;</div><div class="line">			value_new[cate_new]=count[i]*value[i];</div><div class="line">			cost_new[cate_new]=count[i]*cost[i];</div><div class="line">		&#125;else if(i==cate)&#123;</div><div class="line">			cate_new--;</div><div class="line">		&#125;</div><div class="line">		i++;</div><div class="line">	&#125;</div><div class="line">//        for(i=0;i&lt;=cate_new;i++)</div><div class="line">//            System.out.print(value_new[i]+&quot;:&quot;+cost_new[i]+&quot; &gt;&quot;);</div><div class="line">//        System.out.println(cate_new);</div><div class="line">	//之后便等同于01背包了</div><div class="line">	int[] dp = new int[cubage+1];</div><div class="line">	for(i=0;i&lt;=cate_new;i++)&#123;</div><div class="line">		//依赖上层保存的j-cost[i]信息，所以此时需要从后往前更新</div><div class="line">		for(j=cubage;j&gt;=cost_new[i];j--)&#123;</div><div class="line">			if(i==0)</div><div class="line">				dp[j]=0;</div><div class="line">			else if(dp[j-cost_new[i]]+value_new[i]&gt;dp[j])</div><div class="line">				dp[j]=dp[j-cost_new[i]]+value_new[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	for(i=0;i&lt;=cubage;i++)</div><div class="line">		System.out.print(dp[i]+&quot; &quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其实也有O(cate*cubage)的算法，参考<a href="http://blog.csdn.net/u013923947/article/details/40371243" target="_blank" rel="external">多重背包单调队列优化</a></p>
<p>参考链接：</p>
<ol>
<li><a href="http://blog.csdn.net/zyy173533832/article/details/10042281" target="_blank" rel="external">白话01背包</a></li>
<li><a href="http://blog.csdn.net/chuck001002004/article/details/50340819" target="_blank" rel="external">多重背包模板</a></li>
<li>流传颇广的<a href="http://blog.csdn.net/ling_du/article/details/41594767" target="_blank" rel="external">背包九讲</a></li>
<li><a href="http://blog.csdn.net/a272846945/article/details/50917889" target="_blank" rel="external">dp背包问题小结</a></li>
<li><a href="http://www.cppblog.com/tanky-woo/archive/2010/07/31/121803.html" target="_blank" rel="external">背包问题详解</a></li>
<li><a href="http://blog.csdn.net/tingting256/article/details/51150208" target="_blank" rel="external">背包问题详解与实现</a></li>
</ol>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="https://buaanie.github.io/2017/10/02/背包问题/" data-id="cj8af4lpa00012obuh5e3z5t8" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2017/09/24/网络复习/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">下一篇</strong>
            <div class="article-nav-title">网络复习</div>
        </a>
    
</nav>


    
</article>


    
    

</section>
            
                
<aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/10/02/背包问题/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/算法笔记/">算法笔记</a></p>
                            <p class="item-title"><a href="/2017/10/02/背包问题/" class="title">背包问题</a></p>
                            <p class="item-date"><time datetime="2017-10-02T13:30:08.000Z" itemprop="datePublished">2017-10-02</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/09/24/网络复习/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/网络/">网络</a></p>
                            <p class="item-title"><a href="/2017/09/24/网络复习/" class="title">网络复习</a></p>
                            <p class="item-date"><time datetime="2017-09-24T04:17:00.000Z" itemprop="datePublished">2017-09-24</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/09/10/最长公共子序列/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/算法笔记/">算法笔记</a></p>
                            <p class="item-title"><a href="/2017/09/10/最长公共子序列/" class="title">最长公共子序列</a></p>
                            <p class="item-date"><time datetime="2017-09-09T16:54:45.000Z" itemprop="datePublished">2017-09-10</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/09/02/排序算法/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/算法笔记/">算法笔记</a></p>
                            <p class="item-title"><a href="/2017/09/02/排序算法/" class="title">排序算法</a></p>
                            <p class="item-date"><time datetime="2017-09-02T04:54:45.000Z" itemprop="datePublished">2017-09-02</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2017/08/28/prevent-spiders/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/技术/">技术</a></p>
                            <p class="item-title"><a href="/2017/08/28/prevent-spiders/" class="title">前端与反爬虫</a></p>
                            <p class="item-date"><time datetime="2017-08-28T02:36:00.000Z" itemprop="datePublished">2017-08-28</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法笔记/">算法笔记</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/随感/">随感</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">3</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态规划/">动态规划</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基础/">基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排序/">排序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/源码/">源码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/背包问题/">背包问题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/转载/">转载</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随感/">随感</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>

            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2017 Nie Jian<br>
            Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/ppoffice/hexo-theme-icarus">icarus</a>
        </div>
    </div>
</footer>
        


    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>